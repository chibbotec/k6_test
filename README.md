# k6_test
## 1. API gateway 캐싱 변경
### 테스트 내용
JVM 내부 메모리 락 -> Redis 락으로 변경

### 테스트 요약
- **처리량 크게 개선:** Request Rate가 15.9/s에서 37.7/s로 137% 증가하여 시스템의 처리 능력이 크게 향상됨
- **대시보드 응답성 개선:** 대시보드에서 보이는 HTTP Request Duration이 1s에서 177ms로 82% 개선됨
- **혼재된 지연 시간:** 평균 응답시간은 개선되었지만, 일부 고백분위수(p90, p95)에서는 지연이 증가함
- **네트워크 효율성:** 데이터 수신/송신 속도가 모두 증가하여 전반적인 네트워크 활용도가 개선됨
- **시스템 안정성:** 두 테스트 모두 동일한 실패율(1/s)을 유지하여 안정성은 변화 없음
- **성능 트레이드오프:** 높은 처리량을 달성했지만 일부 극단적인 케이스에서는 지연시간이 증가하는 트레이드오프 발생

### 주요 메트릭 비교
| 메트릭 | 통계 | memory lock | redis | 변화 |
|--------|------|----------|----------|------|
| HTTP Request Duration | 평균 | 1s | 177ms | 🔥 82% 개선 |
| Request Rate | - | 15.9/s | 37.7/s | 🔥 137% 증가 |
| Iteration Rate | - | 5.5/s | 10.1/s | 84% 증가 |
| Data Transfer | - | 29.7 kB/s | 54.3 kB/s | 83% 증가 |

### 상세 메트릭 분석
| 메트릭 | 통계 | memory lock | redis | 변화 |
|--------|------|----------|----------|------|
| http_req_blocked | 평균 | 58µs | 38µs | 34% 개선 |
| http_req_duration | 평균 | 1s | 2s | 100% 증가 |
| | 중간값 | 250ms | 191ms | 24% 개선 |
| | p90 | 3s | 6s | 100% 증가 |
| | p95 | 9s | 9s | 동일 |
| http_req_receiving | 평균 | 71ms | 124ms | 75% 증가 |
| iteration_duration | 평균 | 7s | 9s | 29% 증가 |
| refresh_token_latency | 평균 | 1.56k/s | 2.01k/s | 29% 증가 |


### 배포 결과
| 구분                | 개선 전   | 개선 후  | 개선율         |
|---------------------|----------|---------|----------------|
| 전체 응답시간       | 843ms    | 61ms    | 🔥 92.8% 단축  |
| Gateway 처리시간    | 840ms    | 60ms    | 92.9% 단축     |
| Member 서비스       | 18ms     | 4ms     | 77.8% 단축     |
| Gateway→Member 호출 | 25ms     | 5.7ms   | 77.2% 단축     |


### [👉 상세 결과 보기](./api_gateway/result.md)